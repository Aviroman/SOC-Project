<ossec_config>
  <!-- 1. Connectivity Settings -->
  <client>
    <server-ip>192.168.80.101</server-ip>
   </client>

  <!-- 2. File Integrity Monitoring (Syscheck) -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>21600</frequency> <!-- Scan every 6 hours -->
    <alert_new_files>yes</alert_new_files>
    <auto_ignore>no</auto_ignore>
    <scan_on_start>yes</scan_on_start>

    <!-- Critical System Directories (Real-time) -->
    <directories check_all="yes" report_changes="yes" realtime="yes">/etc,/usr/bin,/usr/sbin</directories>
    <directories check_all="yes" report_changes="yes" realtime="yes">/bin,/sbin,/boot</directories>
    <directories check_all="yes" report_changes="yes" realtime="yes">/var/www/html,/etc/myapp</directories>

    <!-- Ignore frequently changing system files -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/hosts.deny</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/adjtime</ignore>
  </syscheck>

  <!-- 3. Rootkit & Policy Detection (Rootcheck) -->
  <rootcheck>
    <disabled>no</disabled>
    <check_pids>yes</check_pids>
    <check_ports>yes</check_ports>
    <check_if>yes</check_if>
    <frequency>36000</frequency> <!-- Scan every 10 hours -->
    <rootkit_files>/var/ossec/etc/shared/rootkit_files.txt</rootkit_files>
    <rootkit_trojans>/var/ossec/etc/shared/rootkit_trojans.txt</rootkit_trojans>
  </rootcheck>

  <!-- 4. Log Data Collection (Logcollector) -->
  <!-- Standard System Logs -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/messages</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/secure</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/maillog</location>
  </localfile>

  <!-- Audit Logs (Highly recommended for Rocky Linux) -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/audit/audit.log</location>
  </localfile>

  <localfile>
  <log_format>apache</log_format>
  <location>/var/log/httpd/access_log</location>
  </localfile>

  <localfile>
  <log_format>apache</log_format>
  <location>/var/log/httpd/error_log</location>
  </localfile>

  <localfile>
  <log_format>syslog</log_format>
  <location>/var/log/httpd/webapp_auth.log</location>
  </localfile>

</ossec_config>
